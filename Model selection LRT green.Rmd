---
title: "Model selection LRT green"
author: "Olsson et al."
date: "1/12/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Loading packages required to run the analysis and the plotting

```{r}
library(lattice)
library(graphics)
library(psyphy)
library(lmerTest)
library(MASS)
library(glm2)
library(readr)
```

Reading the data, this function below reads comma-separated-values(.csv) files.
# The script is constructed such that you should have one column with the number of correct choices ("corr" in the current version),
# a second column with the number of incorrect choices("incorr" in the current version), and a third column representing the stimulus levels ("lint" in the current version; could be intensity, or whatever). 
# additional variables can be added

```{r}
data <- read.csv('green colours.csv', header = TRUE, sep = ";", row.names = NULL) # change the "Working Directory" to the folder containing your data file. Change the name xxxxx.csv to your filename
data$background <- factor(data$background)
data$ind <- factor(data$ind)
data$batch <- as.factor(data$batch)
```

## Model testing, full and removing one factor at a time, simulating stepAIC

### setting up models

```{r}
mod.0 <- glm.WH(cbind(corr,incorr)~1, data = data, lambda.init = 0.1, interval = c(0, 1), NumAlt = 2) # Null model, data is explained only by variance. lambda.init is your estimate of the upper asymptote and NumAlt specifies the number of alternatives e.g. 2 alternative forced choice
mod.1 <- glm.WH(cbind(corr,incorr)~Colour.difference*background*sex+ind+batch, data = data, lambda.init = 0.05, interval = c(0, 1), NumAlt = 2, maxit=1000) # Model where data is affected by the stimulus level
mod.2 <- glm.WH(cbind(corr,incorr)~Colour.difference*background+sex+ind+batch, data = data, lambda.init = 0.05, interval = c(0, 1), NumAlt = 2, maxit=100) # Model where data is affected by the stimulus level
mod.21 <- glm.WH(cbind(corr,incorr)~Colour.difference*background+Colour.difference*sex+background*sex+ind+batch, data = data, lambda.init = 0.05, interval = c(0, 1), NumAlt = 2, maxit=100) # Model where data is affected by the stimulus level
mod.3 <- glm.WH(cbind(corr,incorr)~Colour.difference*background+ind+batch, data = data, lambda.init = 0.06, interval = c(0, 1), NumAlt = 2, maxit=100) # Model where data is affected by the stimulus level
mod.4 <- glm.WH(cbind(corr,incorr)~Colour.difference*background+ind+sex, data = data, lambda.init = 0.06, interval = c(0, 1), NumAlt = 2, maxit=100) # Model where data is affected by the stimulus level
mod.5 <- glm.WH(cbind(corr,incorr)~Colour.difference+background+ind+batch+sex, data = data, lambda.init = 0.05, interval = c(0, 1), NumAlt = 2) # Model where data is affected by the stimulus level
AIC(mod.0, mod.1, mod.2, mod.3, mod.4, mod.5)
anova(mod.0, mod.1, test="Chisq")
```


```{r}
anova(mod.1, mod.2, test= "Chisq")
```



```{r}
anova(mod.1, mod.3, test= "Chisq")
```


```{r}
anova(mod.1, mod.4, test= "Chisq")
```



```{r}
anova(mod.1, mod.5, test="Chisq")
```


```{r}
anova(mod.1,mod.2,mod.3,mod.4,mod.5, test="Chisq")
```


```{r}
anova(mod.1)
```


```{r}
summary(mod.1)
```
